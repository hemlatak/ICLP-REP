

select account_number,customer_id,count(*) from ncb_cms_customer
group by account_number,customeR_id
having count(*)>1;

 
 select o.*
from ncb_cms_customer o 
inner join ( 
   select account_number,customer_id,count(*)as count from ncb_cms_customer
group by account_number,customeR_id
having count(*)>1
) oc on o.account_number = oc.account_number 
and  o.customer_id = oc.customer_id 

--3918
 

SELECT 
    *
FROM ( 
     SELECT  
        account_number,customer_id,
         ROW_NUMBER() OVER (PARTITION BY account_number,customer_id ORDER BY account_number,customer_id) AS intRow 
     FROM ncb_cms_customer 
) AS d 
WHERE intRow != 1 ;


SELECT 
   *
FROM ( 
     SELECT account_number,customer_id, COUNT(*) as intCount, MIN(AUTONO) AS minId 
     FROM ncb_cms_customer 
     GROUP BY account_number,customer_id
     HAVING COUNT(*) > 1 
) AS d 
    INNER JOIN ncb_cms_customer o ON
 o.account_number = d.account_number 
and  o.customer_id = d.customer_id 
WHERE d.minId != o.AUTONO 


---deleting duplicate rows

DELETE FROM Amyali_emiles_temp1 WHERE 
auto_no IN( SELECT    MAX(auto_no) FROM Amyali_emiles_temp1 
GROUP BY account_number,customer_id,full_name,email
HAVING COUNT(*) > 1)





